<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶ï‡ßç‡¶∞‡¶ø‡¶ï‡ßá‡¶ü ‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶®‡¶ø‡¶≤‡¶æ‡¶Æ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            padding: 20px;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 20px;
            right: 20px;
            width: 150px;
            height: 150px;
            background-image: url('https://munnacodsit.xyz/Tournament-Lottery/in/aa.jpeg');
            background-size: cover;
            background-position: center;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
            z-index: 1;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            z-index: 10;
        }

        .category-tabs {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .category-tab {
            background: white;
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.2em;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .category-tab:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .category-tab.active {
            background: linear-gradient(135deg, #ea580c 0%, #dc2626 100%);
            color: white;
        }

        .category-tab.iconic { border: 3px solid #9333ea; }
        .category-tab.normal { border: 3px solid #0284c7; }

        .bank-panel {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            text-align: center;
        }

        .bank-panel h2 {
            color: #1e5128;
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        .bank-input-group {
            display: flex;
            gap: 10px;
            justify-content: center;
            align-items: center;
            margin-bottom: 15px;
        }

        .bank-input-group input {
            padding: 10px;
            border: 2px solid #d1d5db;
            border-radius: 5px;
            font-size: 1em;
            width: 200px;
            text-align: center;
        }

        .bank-input-group button {
            background: #059669;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: background 0.3s;
        }

        .bank-input-group button:hover {
            background: #047857;
        }

        .bank-input-group .btn-increment {
            background: #f59e0b;
        }

        .bank-input-group .btn-increment:hover {
            background: #d97706;
        }

        .bank-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .bank-actions button {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: background 0.3s;
        }

        .btn-result-sheet {
            background: #0284c7;
            color: white;
        }

        .btn-result-sheet:hover {
            background: #0369a1;
        }
        
        .btn-reset-data {
            background: #dc2626;
            color: white;
        }

        .btn-reset-data:hover {
            background: #991b1b;
        }

        .player-screen {
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            text-align: center;
            min-height: 600px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .player-image-large {
            width: 300px;
            height: 300px;
            border-radius: 50%;
            object-fit: cover;
            margin: 0 auto 30px;
            border: 8px solid #ea580c;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .player-name-large {
            font-size: 3em;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 20px;
        }

        .player-category-badge {
            display: inline-block;
            padding: 10px 30px;
            border-radius: 25px;
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .badge-iconic {
            background: linear-gradient(135deg, #9333ea 0%, #7e22ce 100%);
            color: white;
        }

        .badge-normal {
            background: linear-gradient(135deg, #0284c7 0%, #0369a1 100%);
            color: white;
        }

        .price-info-box {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 30px;
        }

        .base-price-display {
            font-size: 1.8em;
            color: #1e5128;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .sold-price-display {
            font-size: 2.5em;
            color: #dc2626;
            font-weight: bold;
        }

        .team-selector {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .team-btn {
            background: white;
            color: #1f2937;
            padding: 12px 25px;
            border: 3px solid #d1d5db;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: all 0.3s;
        }

        .team-btn:hover {
            transform: scale(1.05);
            border-color: #9333ea;
        }

        .team-btn.selected {
            background: linear-gradient(135deg, #9333ea 0%, #7e22ce 100%);
            color: white;
            border-color: #9333ea;
        }

        .navigation-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 30px;
        }

        .nav-btn {
            background: #ea580c;
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.2em;
            font-weight: bold;
            transition: all 0.3s;
        }

        .nav-btn:hover {
            background: #dc2626;
            transform: scale(1.05);
        }

        .nav-btn:disabled {
            background: #9ca3af;
            cursor: not-allowed;
            transform: scale(1);
        }

        .player-counter {
            font-size: 1.3em;
            color: #6b7280;
            margin-top: 20px;
        }

        .no-players {
            font-size: 1.5em;
            color: #6b7280;
            padding: 100px 20px;
        }

        /* Welcome Page Styles */
        .welcome-page-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1e5128 0%, #2d6a4f 50%, #40916c 100%);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            overflow: hidden;
        }

        .welcome-content {
            position: relative;
            width: 90%;
            max-width: 1000px;
            height: 90vh;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .firework {
            position: absolute;
            width: 5px;
            height: 5px;
            border-radius: 50%;
            animation: explode 1s ease-out forwards;
        }

        @keyframes explode {
            0% {
                transform: translate(0, 0);
                opacity: 1;
            }
            100% {
                transform: translate(var(--tx), var(--ty));
                opacity: 0;
            }
        }

        .welcome-player-image-container {
            margin-bottom: 30px;
            opacity: 0;
            animation: fadeInImage 1s ease-out forwards;
            animation-delay: 1s;
        }

        .welcome-player-img {
            width: 350px;
            height: 350px;
            object-fit: cover;
            border: 8px solid #9333ea;
            border-radius: 15px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }

        @keyframes fadeInImage {
            from {
                opacity: 0;
                transform: scale(0.8) rotate(-5deg);
            }
            to {
                opacity: 1;
                transform: scale(1) rotate(0deg);
            }
        }

        .welcome-message {
            text-align: center;
            max-width: 800px;
            opacity: 0;
            animation: fadeInText 1s ease-out forwards;
            animation-delay: 1.5s;
        }

        .welcome-team-name {
            font-size: 2.5em;
            font-weight: bold;
            color: #9333ea;
            margin-bottom: 20px;
        }

        .welcome-player-name {
            font-size: 2.5em;
            font-weight: bold;
            color: #dc2626;
            margin-bottom: 20px;
        }

        .welcome-text {
            font-size: 1.3em;
            line-height: 1.8;
            color: #1f2937;
            margin-bottom: 15px;
        }

        .welcome-signature {
            font-size: 1.2em;
            font-weight: bold;
            color: #059669;
            margin-top: 30px;
        }

        @keyframes fadeInText {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .close-welcome-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: #dc2626;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            z-index: 10;
        }

        .close-welcome-btn:hover {
            background: #991b1b;
        }

        .result-sheet-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .result-sheet-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
            box-shadow: 0 10px 50px rgba(0,0,0,0.5);
        }

        .result-sheet-content h2 {
            color: #1e5128;
            margin-bottom: 20px;
            text-align: center;
        }

        .team-tabs {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .team-tab {
            background: white;
            color: #1f2937;
            padding: 12px 20px;
            border: 3px solid #d1d5db;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: all 0.3s;
        }

        .team-tab:hover {
            transform: scale(1.05);
            border-color: #9333ea;
        }

        .team-tab.active-team {
            background: linear-gradient(135deg, #9333ea 0%, #7e22ce 100%);
            color: white;
            border-color: #9333ea;
        }

        .view-tabs {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 20px;
        }

        .view-tab {
            background: white;
            color: #1f2937;
            padding: 12px 30px;
            border: 3px solid #d1d5db;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: all 0.3s;
        }

        .view-tab:hover {
            transform: scale(1.05);
            border-color: #0284c7;
        }

        .view-tab.active-view {
            background: linear-gradient(135deg, #0284c7 0%, #0369a1 100%);
            color: white;
            border-color: #0284c7;
        }

        .team-players-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .player-card {
            background: white;
            border: 3px solid #9333ea;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .player-card-image {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            margin: 0 auto 10px;
            border: 4px solid #9333ea;
        }

        .player-card-name {
            font-size: 1.1em;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 8px;
        }

        .player-card-price {
            font-size: 1.2em;
            font-weight: bold;
            color: #059669;
        }

        .no-team-players {
            text-align: center;
            color: #6b7280;
            font-size: 1.2em;
            padding: 40px;
        }

        .result-sheet-content table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        .result-sheet-content th, .result-sheet-content td {
            color: #1f2937;
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }

        .result-sheet-content th {
            background-color: #f3f4f6;
            color: #1f2937;
        }

        .result-sheet-content .close-btn {
            background: #dc2626;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            display: block;
            margin: 0 auto;
        }

        .result-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 20px;
        }

        .btn-download-pdf {
            background: #059669;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
        }

        .btn-download-pdf:hover {
            background: #047857;
        }

        .pdf-preview {
            display: none;
            position: fixed;
            left: -9999px;
            top: 0;
        }

        .pdf-page {
            width: 210mm;
            min-height: 297mm;
            padding: 15mm;
            background: white;
            box-sizing: border-box;
            page-break-after: always;
            margin-bottom: 10px;
        }

        .pdf-page h1 {
            text-align: center;
            color: #1e5128;
            margin-bottom: 20px;
            font-size: 24px;
        }

        .pdf-page-number {
            text-align: center;
            color: #6b7280;
            font-size: 12px;
            margin-top: 20px;
            padding-top: 10px;
            border-top: 1px solid #d1d5db;
        }

        .pdf-page table {
            width: 100%;
            border-collapse: collapse;
            font-size: 11px;
        }

        .pdf-page th, .pdf-page td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        .pdf-page th {
            background-color: #1e5128;
            color: white;
            font-weight: bold;
        }

        .pdf-page tr:nth-child(even) {
            background-color: #f3f4f6;
        }

        .pdf-page .sold {
            color: #059669;
            font-weight: bold;
        }

        .pdf-page .unsold {
            color: #ea580c;
            font-weight: bold;
        }

        @media (max-width: 600px) {
            body::before {
                width: 80px;
                height: 80px;
                top: 10px;
                right: 10px;
            }

            body {
                padding: 10px;
            }

            .category-tabs {
                gap: 10px;
            }

            .category-tab {
                padding: 10px 15px;
                font-size: 1em;
            }

            .bank-panel {
                padding: 15px;
            }

            .bank-panel h2 {
                font-size: 1.5em;
            }

            .bank-input-group {
                flex-direction: column;
            }

            .bank-input-group input {
                width: 100%;
            }

            .bank-actions {
                flex-direction: column;
            }

            .bank-actions button {
                width: 100%;
            }

            .player-image-large {
                width: 200px;
                height: 200px;
            }

            .player-name-large {
                font-size: 2em;
            }

            .player-category-badge {
                font-size: 1.2em;
            }

            .welcome-player-img {
                width: 250px;
                height: 250px;
            }

            .welcome-team-name {
                font-size: 1.8em;
            }

            .welcome-player-name {
                font-size: 1.8em;
            }

            .welcome-text {
                font-size: 1.1em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="bank-panel">
            <h2>CIVIL PREMIER LEAGUE</h2>
            <div class="bank-input-group">
                <input type="number" id="auctionPriceInput" placeholder="‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø‡¶§ ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶® (‡¶Ø‡ßá‡¶Æ‡¶®: 150)" readonly>
                <button onclick="incrementPrice()" class="btn-increment">üí∞ ‡¶¶‡¶æ‡¶Æ ‡¶¨‡¶æ‡¶°‡¶º‡¶æ‡¶®</button>
                <button onclick="setAuctionPrice()">‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            </div>
            <div class="bank-actions">
                <button class="btn-result-sheet" onclick="showResultSheet()">
                    ‡¶∞‡ßá‡¶ú‡¶æ‡¶≤‡ßç‡¶ü ‡¶∂‡ßÄ‡¶ü ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®
                </button>
                <button class="btn-reset-data" onclick="resetUnsoldPlayers()" style="background: #f59e0b;">
                    UNSOLD ‚Üí ‡ß®‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ
                </button>
                <button class="btn-reset-data" onclick="resetData()">
                    ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡ßÅ‡¶® (‡¶∏‡¶ï‡¶≤ ‡¶°‡ßá‡¶ü‡¶æ)
                </button>
            </div>
        </div>

        <div class="category-tabs">
            <div class="category-tab iconic active" onclick="changeCategory('ICONIC')">
                üëë ‡¶Ü‡¶á‡¶ï‡¶®‡¶ø‡¶ï ‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞
            </div>
            <div class="category-tab normal" onclick="changeCategory('NORMAL')">
                ‚≠ê ‡¶®‡¶∞‡¶Æ‡¶æ‡¶≤ ‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞
            </div>
        </div>

        <div class="player-screen" id="playerScreen"></div>

        <!-- Welcome Page -->
        <div class="welcome-page-overlay" id="welcomePageOverlay">
            <div class="welcome-content">
                <button class="close-welcome-btn" onclick="closeWelcomePage()">‚úñ ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                
                <div class="welcome-player-image-container" id="welcomePlayerImageContainer"></div>
                
                <div class="welcome-message" id="welcomeMessage"></div>
            </div>
        </div>

        <div class="result-sheet-overlay" id="resultSheetOverlay" onclick="hideResultSheet(event)">
            <div class="result-sheet-content" onclick="event.stopPropagation()">
                <h2>CIVIL PREMIER LEAGUE</h2>
                
                <div class="view-tabs">
                    <div class="view-tab active-view" onclick="changeView('all')">
                        ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶∞‡ßá‡¶ú‡¶æ‡¶≤‡ßç‡¶ü
                    </div>
                    <div class="view-tab" onclick="changeView('team')">
                        ‡¶ü‡¶ø‡¶Æ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ
                    </div>
                </div>

                <div id="teamTabsContainer" style="display: none;">
                    <div class="team-tabs">
                        <div class="team-tab active-team" onclick="showTeamPlayers('Dumuria Kings')">
                            Dumuria Kings
                        </div>
                        <div class="team-tab" onclick="showTeamPlayers('Dumuria Strikers')">
                            Dumuria Strikers
                        </div>
                        <div class="team-tab" onclick="showTeamPlayers('Dumuria Warriors')">
                            Dumuria Warriors
                        </div>
                        <div class="team-tab" onclick="showTeamPlayers('Dumuria Titans')">
                            Dumuria Titans
                        </div>
                        <div class="team-tab" onclick="showTeamPlayers('Dumuria Vikings')">
                            Dumuria Vikings
                        </div>
                    </div>
                </div>

                <div class="result-actions">
                    <button class="btn-download-pdf" id="downloadBtn" onclick="downloadAllResult()">
                        üì• ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶∞‡ßá‡¶ú‡¶æ‡¶≤‡ßç‡¶ü ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®
                    </button>
                </div>

                <div id="resultContainer"></div>

                <button class="close-btn" onclick="hideResultSheet()">‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            </div>
        </div>

        <div id="pdfPreview" class="pdf-preview"></div>
        <div id="teamImagePreview" class="pdf-preview"></div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script>
        let allPlayers = [];
        let currentCategory = 'ICONIC';
        let currentPlayerIndex = 0;
        let currentTeam = 'Dumuria Kings';
        let currentView = 'all';
        const teams = ["Dumuria Kings", "Dumuria Strikers", "Dumuria Warriors", "Dumuria Titans", "Dumuria Vikings"];

        const teamWelcomeMessages = {
            "Dumuria Kings": `{playerName} ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ü‡¶ø‡¶Æ‡ßá ‡¶Ü‡¶®‡ßç‡¶§‡¶∞‡¶ø‡¶ï ‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ‡•§
‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¶‡¶ï‡ßç‡¶∑‡¶§‡¶æ ‡¶ì ‡¶Ö‡¶≠‡¶ø‡¶ú‡ßç‡¶û‡¶§‡¶æ ‡¶è‡¶á ‡¶ü‡¶ø‡¶Æ‡¶ï‡ßá ‡¶Ü‡¶∞‡¶ì ‡¶∂‡¶ï‡ßç‡¶§‡¶ø‡¶∂‡¶æ‡¶≤‡ßÄ ‡¶ï‡¶∞‡¶¨‡ßá ‡¶¨‡¶≤‡ßá ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶¨‡¶ø‡¶∂‡ßç‡¶¨‡¶æ‡¶∏ ‡¶ï‡¶∞‡¶ø‡•§
‡¶è‡¶á ‡¶Æ‡ßå‡¶∏‡ßÅ‡¶Æ‡ßá Dumuria Kings‚Äì‡¶è‡¶∞ ‡¶ú‡¶æ‡¶∞‡ßç‡¶∏‡¶ø‡¶§‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá ‡¶™‡ßá‡¶Ø‡¶º‡ßá ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶ó‡¶∞‡ßç‡¶¨‡¶ø‡¶§‡•§
‡¶∂‡ßÅ‡¶≠‡¶ï‡¶æ‡¶Æ‡¶®‡¶æ ‡¶∞‡¶á‡¶≤‡ßã ‡¶è‡¶ï‡¶ü‡¶ø ‡¶∏‡¶´‡¶≤ ‡¶Æ‡ßå‡¶∏‡ßÅ‡¶Æ‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§`,
            
            "Dumuria Strikers": `{playerName}‚Äì‡¶ï‡ßá ‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ‡•§
‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶≠‡¶æ ‡¶ì ‡¶™‡¶∞‡¶ø‡¶∂‡ßç‡¶∞‡¶Æ ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ü‡¶ø‡¶Æ‡ßá‡¶∞ ‡¶∂‡¶ï‡ßç‡¶§‡¶ø ‡¶¨‡¶æ‡¶°‡¶º‡¶æ‡¶¨‡ßá‡•§
‡¶ö‡¶≤‡ßÅ‡¶®, ‡¶è‡¶ï‡¶∏‡¶æ‡¶•‡ßá ‡¶≤‡¶°‡¶º‡¶æ‡¶á ‡¶ï‡¶∞‡ßá ‡¶è‡¶á ‡¶Æ‡ßå‡¶∏‡ßÅ‡¶Æ‡¶ï‡ßá ‡¶∏‡ßç‡¶Æ‡¶∞‡¶£‡ßÄ‡¶Ø‡¶º ‡¶ï‡¶∞‡ßá ‡¶§‡ßÅ‡¶≤‡¶ø‡•§
‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶∞‡¶á‡¶≤‡ßã ‡¶∂‡ßÅ‡¶≠‡¶ï‡¶æ‡¶Æ‡¶®‡¶æ‡•§`,
            
            "Dumuria Warriors": `{playerName}‚Äì‡¶ï‡ßá ‡¶Ü‡¶®‡ßç‡¶§‡¶∞‡¶ø‡¶ï ‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ‡•§
‡¶è‡¶á ‡¶ü‡¶ø‡¶Æ ‡¶Æ‡¶æ‡¶®‡ßá ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶ñ‡ßá‡¶≤‡¶æ ‡¶®‡¶Ø‡¶º‚Äî‡¶è‡¶ü‡¶æ ‡¶∏‡¶Æ‡ßç‡¶Æ‡¶æ‡¶®, ‡¶¶‡¶æ‡¶Ø‡¶º‡¶ø‡¶§‡ßç‡¶¨ ‡¶ì ‡¶ê‡¶ï‡ßç‡¶Ø‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶§‡ßÄ‡¶ï‡•§
‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶Ç‡¶∂‡¶ó‡ßç‡¶∞‡¶π‡¶£‡ßá ‡¶ü‡¶ø‡¶Æ ‡¶Ü‡¶∞‡¶ì ‡¶∂‡¶ï‡ßç‡¶§‡¶ø‡¶∂‡¶æ‡¶≤‡ßÄ ‡¶π‡¶¨‡ßá ‡¶¨‡¶≤‡ßá ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶Ü‡¶∂‡¶æ‡¶¨‡¶æ‡¶¶‡ßÄ‡•§`,
            
            "Dumuria Titans": `{playerName}‚Äì‡¶ï‡ßá ‡¶™‡ßá‡¶Ø‡¶º‡ßá ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶Ü‡¶®‡¶®‡ßç‡¶¶‡¶ø‡¶§‡•§
‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡ßç‡¶ï‡¶ø‡¶≤ ‡¶ì ‡¶Æ‡¶æ‡¶†‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶®‡¶∏‡¶ø‡¶ï‡¶§‡¶æ ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø ‡¶Ö‡¶∞‡ßç‡¶ú‡¶®‡ßá ‡¶¨‡¶°‡¶º ‡¶≠‡ßÇ‡¶Æ‡¶ø‡¶ï‡¶æ ‡¶∞‡¶æ‡¶ñ‡¶¨‡ßá‡•§
‡¶è‡¶á ‡¶Æ‡ßå‡¶∏‡ßÅ‡¶Æ‡ßá ‡¶è‡¶ï‡¶∏‡¶æ‡¶•‡ßá ‡¶∏‡ßá‡¶∞‡¶æ ‡¶™‡¶æ‡¶∞‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶∏‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶§‡ßç‡¶Ø‡¶æ‡¶∂‡¶æ ‡¶∞‡¶á‡¶≤‡ßã‡•§`,
            
            "Dumuria Vikings": `{playerName} ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá ‡¶ü‡¶ø‡¶Æ‡ßá ‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ‡•§
‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶≠‡¶ø‡¶ú‡ßç‡¶û‡¶§‡¶æ ‡¶ì ‡¶Ü‡¶§‡ßç‡¶Æ‡¶®‡¶ø‡¶¨‡ßá‡¶¶‡¶® ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ü‡¶ø‡¶Æ‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø‡¶¨‡¶æ‡¶® ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ú‡¶®‡•§
‡¶ö‡¶≤‡ßÅ‡¶®, ‡¶è‡¶ï‡¶∏‡¶æ‡¶•‡ßá ‡¶ñ‡ßá‡¶≤‡¶ø, ‡¶è‡¶ï‡¶∏‡¶æ‡¶•‡ßá ‡¶ú‡¶ø‡¶§‡¶ø‡•§`
        };

        const defaultPlayers = [
            // Iconic Players
            { name: "‡¶∏‡¶æ‡¶ï‡¶ø‡¶¨ ‡¶Ü‡¶≤ ‡¶π‡¶æ‡¶∏‡¶æ‡¶®", category: "ICONIC", basePrice: "100", imageURL: "https://upload.wikimedia.org/wikipedia/commons/thumb/c/cc/Shakib_Al_Hasan_%28crop%29.jpg/800px-Shakib_Al_Hasan_%28crop%29.jpg", auctionPrice: null, team: null },
            { name: "‡¶Æ‡ßÅ‡¶∂‡¶´‡¶ø‡¶ï‡ßÅ‡¶∞ ‡¶∞‡¶π‡¶ø‡¶Æ", category: "ICONIC", basePrice: "100", imageURL: "https://upload.wikimedia.org/wikipedia/commons/thumb/8/8c/Mushfiqur_Rahim_2018_%28cropped%29.jpg/800px-Mushfiqur_Rahim_2018_%28cropped%29.jpg", auctionPrice: null, team: null },
            { name: "‡¶Æ‡¶æ‡¶π‡¶Æ‡ßÅ‡¶¶‡¶â‡¶≤‡ßç‡¶≤‡¶æ‡¶π ‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶¶", category: "ICONIC", basePrice: "100", imageURL: "https://upload.wikimedia.org/wikipedia/commons/thumb/4/4c/Mahmudullah_Riyad_in_2018.jpg/800px-Mahmudullah_Riyad_in_2018.jpg", auctionPrice: null, team: null },
            { name: "‡¶§‡¶æ‡¶∏‡¶ï‡¶ø‡¶® ‡¶Ü‡¶π‡¶Æ‡ßá‡¶¶", category: "ICONIC", basePrice: "100", imageURL: "https://upload.wikimedia.org/wikipedia/commons/thumb/d/d0/Taskin_Ahmed_%28cropped%29.jpg/800px-Taskin_Ahmed_%28cropped%29.jpg", auctionPrice: null, team: null },
            { name: "‡¶π‡¶æ‡¶Æ‡¶ú‡¶æ ‡¶Æ‡ßã‡¶≤‡ßç‡¶≤‡¶æ", category: "ICONIC", basePrice: "100", imageURL: "https://vip.munnacodsit.xyz/mu/HamzaMulla.jpg", auctionPrice: null, team: null },
            { name: "‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ‡¶¨ ‡¶ó‡¶æ‡¶ú‡ßÄ", category: "ICONIC", basePrice: "100", imageURL: "https://vip.munnacodsit.xyz/mu/ShiabGazi.jpg", auctionPrice: null, team: null },
            { name: "‡¶§‡¶æ‡¶Æ‡¶ø‡¶Æ ‡¶á‡¶ï‡¶¨‡¶æ‡¶≤", category: "ICONIC", basePrice: "100", imageURL: "", auctionPrice: null, team: null },
            { name: "‡¶Æ‡¶æ‡¶∂‡¶∞‡¶æ‡¶´‡¶ø ‡¶¨‡¶ø‡¶® ‡¶Æ‡¶∞‡ßç‡¶§‡ßÅ‡¶ú‡¶æ", category: "ICONIC", basePrice: "100", imageURL: "", auctionPrice: null, team: null },
            { name: "‡¶≤‡¶ø‡¶ü‡¶® ‡¶¶‡¶æ‡¶∏", category: "ICONIC", basePrice: "100", imageURL: "", auctionPrice: null, team: null },
            { name: "‡¶Æ‡ßá‡¶π‡ßá‡¶¶‡ßÄ ‡¶π‡¶æ‡¶∏‡¶æ‡¶® ‡¶Æ‡¶ø‡¶∞‡¶æ‡¶ú", category: "ICONIC", basePrice: "100", imageURL: "", auctionPrice: null, team: null },
            
            // Normal Players
            { name: "‡¶Æ‡ßã‡¶É ‡¶Æ‡ßã‡¶¨‡¶æ‡¶∞‡¶ï ‡¶π‡ßã‡¶∏‡ßá‡¶® ‡¶Æ‡ßÅ‡¶®‡ßç‡¶®‡¶æ", category: "NORMAL", basePrice: "50", imageURL: "https://vip.munnacodsit.xyz/mu/MUNNAPRO.jpg", auctionPrice: null, team: null },
            { name: "‡¶Æ‡ßã‡¶É ‡¶ú‡¶ø‡¶π‡¶æ‡¶¶", category: "NORMAL", basePrice: "50", imageURL: "https://vip.munnacodsit.xyz/mu/MdJihad.jpg", auctionPrice: null, team: null },
            { name: "‡¶Æ‡ßÅ‡¶∏‡ßç‡¶§‡¶æ‡¶´‡¶ø‡¶ú‡ßÅ‡¶∞ ‡¶∞‡¶π‡¶Æ‡¶æ‡¶®", category: "NORMAL", basePrice: "50", imageURL: "", auctionPrice: null, team: null },
            { name: "‡¶∂‡¶∞‡¶ø‡¶´‡ßÅ‡¶≤ ‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ", category: "NORMAL", basePrice: "50", imageURL: "", auctionPrice: null, team: null },
            { name: "‡¶Ü‡¶´‡¶ø‡¶´ ‡¶π‡ßã‡¶∏‡ßá‡¶®", category: "NORMAL", basePrice: "50", imageURL: "", auctionPrice: null, team: null },
            { name: "‡¶®‡¶æ‡¶∏‡ßÅ‡¶Æ ‡¶Ü‡¶π‡¶Æ‡ßá‡¶¶", category: "NORMAL", basePrice: "50", imageURL: "", auctionPrice: null, team: null },
            { name: "‡¶∏‡ßå‡¶Æ‡ßç‡¶Ø ‡¶∏‡¶∞‡¶ï‡¶æ‡¶∞", category: "NORMAL", basePrice: "50", imageURL: "", auctionPrice: null, team: null },
            { name: "‡¶∞‡ßÅ‡¶¨‡ßá‡¶≤ ‡¶π‡ßã‡¶∏‡ßá‡¶®", category: "NORMAL", basePrice: "50", imageURL: "", auctionPrice: null, team: null },
            { name: "‡¶∏‡¶æ‡¶¨‡ßç‡¶¨‡¶ø‡¶∞ ‡¶∞‡¶π‡¶Æ‡¶æ‡¶®", category: "NORMAL", basePrice: "50", imageURL: "", auctionPrice: null, team: null },
            { name: "‡¶Æ‡ßã‡¶∏‡ßç‡¶§‡¶æ‡¶´‡¶ø‡¶ú", category: "NORMAL", basePrice: "50", imageURL: "", auctionPrice: null, team: null },
            { name: "‡¶Ü‡¶≤-‡¶Ü‡¶Æ‡¶ø‡¶® ‡¶π‡ßã‡¶∏‡ßá‡¶®", category: "NORMAL", basePrice: "50", imageURL: "", auctionPrice: null, team: null },
            { name: "‡¶á‡¶Æ‡¶∞‡ßÅ‡¶≤ ‡¶ï‡¶æ‡¶Ø‡¶º‡ßá‡¶∏", category: "NORMAL", basePrice: "50", imageURL: "", auctionPrice: null, team: null },
            { name: "‡¶®‡¶æ‡¶ú‡¶Æ‡ßÅ‡¶≤ ‡¶π‡ßã‡¶∏‡ßá‡¶® ‡¶∂‡¶æ‡¶®‡ßç‡¶§", category: "NORMAL", basePrice: "50", imageURL: "", auctionPrice: null, team: null },
            { name: "‡¶∂‡¶æ‡¶Æ‡¶∏‡ßÅ‡¶∞ ‡¶∞‡¶π‡¶Æ‡¶æ‡¶®", category: "NORMAL", basePrice: "50", imageURL: "", auctionPrice: null, team: null },
            { name: "‡¶Ü‡¶¨‡ßÅ ‡¶π‡¶æ‡¶Ø‡¶º‡¶¶‡¶æ‡¶∞", category: "NORMAL", basePrice: "50", imageURL: "", auctionPrice: null, team: null },
        ];
        
        function init() {
            loadFromStorage();
            displayCurrentPlayer();
        }

        function loadFromStorage() {
            const storedPlayers = localStorage.getItem('cricketPlayers');
            if (storedPlayers) {
                const stored = JSON.parse(storedPlayers);
                // Check if old categories (A, B, C) exist - if yes, reset to new data
                const hasOldCategories = stored.some(p => ['A', 'B', 'C'].includes(p.category));
                if (hasOldCategories) {
                    // Reset to new default players with ICONIC and NORMAL categories
                    allPlayers = JSON.parse(JSON.stringify(defaultPlayers));
                    saveToStorage();
                    console.log('‡¶™‡ßÅ‡¶∞‡¶®‡ßã ‡¶°‡ßá‡¶ü‡¶æ ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá - ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø ‡¶≤‡ßã‡¶° ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá');
                } else {
                    allPlayers = stored;
                }
            } else {
                allPlayers = JSON.parse(JSON.stringify(defaultPlayers));
                saveToStorage();
            }
        }

        function saveToStorage() {
            localStorage.setItem('cricketPlayers', JSON.stringify(allPlayers));
        }

        function getCurrentCategoryPlayers() {
            // Filter out sold players - only show UNSOLD players
            return allPlayers.filter(player => player.category === currentCategory && !player.auctionPrice);
        }

        function changeCategory(newCategory) {
            currentCategory = newCategory;
            currentPlayerIndex = 0;
            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`.category-tab.${newCategory.toLowerCase()}`).classList.add('active');
            displayCurrentPlayer();
        }

        function displayCurrentPlayer() {
            const screen = document.getElementById('playerScreen');
            const currentPlayers = getCurrentCategoryPlayers();
            
            if (currentPlayers.length === 0) {
                screen.innerHTML = '<div class="no-players">‡¶è‡¶á ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø‡¶§‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º ‡¶®‡ßá‡¶á‡•§</div>';
                return;
            }
            
            const player = currentPlayers[currentPlayerIndex];
            const badgeClass = `badge-${player.category.toLowerCase()}`;
            
            // Initialize price input with base price
            const priceInput = document.getElementById('auctionPriceInput');
            if (priceInput && !player.auctionPrice) {
                priceInput.value = player.basePrice;
            } else if (priceInput && player.auctionPrice) {
                priceInput.value = '';
            }
            
            let teamSelector = '';
            if (!player.auctionPrice) {
                teamSelector = `<div class="team-selector">${teams.map(team => `<button class="team-btn ${player.team === team ? 'selected' : ''}" onclick="selectTeam('${team}')">${team}</button>`).join('')}</div>`;
            }
            
            const categoryText = player.category === 'ICONIC' ? '‡¶Ü‡¶á‡¶ï‡¶®‡¶ø‡¶ï ‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞' : '‡¶®‡¶∞‡¶Æ‡¶æ‡¶≤ ‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞';
            
            const priceDisplay = player.auctionPrice 
                ? `<div class="price-info-box"><div class="base-price-display">üí∞ BASE PRICE: ${player.basePrice}</div><div class="sold-price-display">‚úÖ SOLD PRICE: ${player.auctionPrice}</div>${player.team ? `<div class="base-price-display" style="color: #9333ea; margin-top: 10px;">üèÜ ‡¶ü‡¶ø‡¶Æ: ${player.team}</div>` : ''}</div>`
                : `<div class="price-info-box"><div class="base-price-display">üí∞ BASE PRICE: ${player.basePrice}</div><div class="sold-price-display" style="color: #ea580c;">UNSOLD</div></div>`;
            
            const imageHTML = player.imageURL 
                ? `<img src="${player.imageURL}" alt="${player.name}" class="player-image-large">`
                : `<div class="player-image-large" style="background-color: #f3f4f6; border: 8px solid #9ca3af; display: flex; align-items: center; justify-content: center; font-size: 1.5em; color: #6b7280;">‡¶õ‡¶¨‡¶ø ‡¶®‡ßá‡¶á</div>`;
            
            screen.innerHTML = `${imageHTML}<div class="player-name-large">${player.name}</div><div class="player-category-badge ${badgeClass}">${categoryText}</div>${priceDisplay}${teamSelector}<div class="navigation-buttons"><button class="nav-btn" onclick="previousPlayer()" ${currentPlayerIndex === 0 ? 'disabled' : ''}>‚¨ÖÔ∏è ‡¶Ü‡¶ó‡ßá‡¶∞</button><button class="nav-btn" onclick="nextPlayer()" ${currentPlayerIndex === currentPlayers.length - 1 ? 'disabled' : ''}>‡¶™‡¶∞‡ßá‡¶∞ ‚û°Ô∏è</button></div><div class="player-counter">${currentPlayerIndex + 1} / ${currentPlayers.length}</div>`;
        }

        function nextPlayer() {
            const currentPlayers = getCurrentCategoryPlayers();
            if (currentPlayerIndex < currentPlayers.length - 1) {
                currentPlayerIndex++;
                displayCurrentPlayer();
            }
        }

        function previousPlayer() {
            if (currentPlayerIndex > 0) {
                currentPlayerIndex--;
                displayCurrentPlayer();
            }
        }

        function selectTeam(teamName) {
            const currentPlayers = getCurrentCategoryPlayers();
            const player = currentPlayers[currentPlayerIndex];
            const playerIndexInAll = allPlayers.findIndex(p => p.name === player.name && p.category === player.category);
            if (playerIndexInAll !== -1) {
                if (allPlayers[playerIndexInAll].team === teamName) {
                    allPlayers[playerIndexInAll].team = null;
                } else {
                    allPlayers[playerIndexInAll].team = teamName;
                }
                saveToStorage();
                displayCurrentPlayer();
            }
        }

        function createFireworks() {
            const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff', '#ff8800', '#ff0088'];
            const welcomeContent = document.querySelector('.welcome-content');
            
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const firework = document.createElement('div');
                    firework.className = 'firework';
                    firework.style.left = Math.random() * 100 + '%';
                    firework.style.top = Math.random() * 100 + '%';
                    firework.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    
                    const tx = (Math.random() - 0.5) * 400;
                    const ty = (Math.random() - 0.5) * 400;
                    firework.style.setProperty('--tx', tx + 'px');
                    firework.style.setProperty('--ty', ty + 'px');
                    
                    welcomeContent.appendChild(firework);
                    
                    setTimeout(() => firework.remove(), 1000);
                }, i * 40);
            }
        }

        function showWelcomePage(player) {
            const overlay = document.getElementById('welcomePageOverlay');
            const playerImageContainer = document.getElementById('welcomePlayerImageContainer');
            const messageDiv = document.getElementById('welcomeMessage');
            
            playerImageContainer.innerHTML = '';
            
            if (player.imageURL) {
                const img = document.createElement('img');
                img.src = player.imageURL;
                img.className = 'welcome-player-img';
                img.alt = player.name;
                playerImageContainer.appendChild(img);
            } else {
                const placeholder = document.createElement('div');
                placeholder.className = 'welcome-player-img';
                placeholder.style.backgroundColor = '#f3f4f6';
                placeholder.style.display = 'flex';
                placeholder.style.alignItems = 'center';
                placeholder.style.justifyContent = 'center';
                placeholder.style.fontSize = '2em';
                placeholder.style.color = '#6b7280';
                placeholder.textContent = '‡¶õ‡¶¨‡¶ø ‡¶®‡ßá‡¶á';
                playerImageContainer.appendChild(placeholder);
            }
            
            const message = teamWelcomeMessages[player.team].replace('{playerName}', player.name);
            const lines = message.split('\n');
            
            messageDiv.innerHTML = `
                <div class="welcome-team-name">${player.team}‚Äì‡¶è‡¶∞ ‡¶™‡¶ï‡ßç‡¶∑ ‡¶•‡ßá‡¶ï‡ßá</div>
                <div class="welcome-player-name">${player.name}</div>
                ${lines.map(line => `<div class="welcome-text">${line}</div>`).join('')}
                <div class="welcome-signature">‚Äî ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü, ${player.team}</div>
            `;
            
            overlay.style.display = 'flex';
            createFireworks();
        }

        function closeWelcomePage() {
            document.getElementById('welcomePageOverlay').style.display = 'none';
        }

        function incrementPrice() {
            const currentPlayers = getCurrentCategoryPlayers();
            if (currentPlayers.length === 0) {
                alert('‚ö†Ô∏è ‡¶ï‡ßã‡¶®‡ßã ‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶®‡ßá‡¶á!');
                return;
            }
            
            const player = currentPlayers[currentPlayerIndex];
            const priceInput = document.getElementById('auctionPriceInput');
            
            let currentPrice = parseInt(priceInput.value) || parseInt(player.basePrice);
            let increment = 0;
            
            // Price increment algorithm:
            // 20-100 ‡¶ü‡¶æ‡¶ï‡¶æ: 10 ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶ï‡¶∞‡ßá ‡¶¨‡ßÉ‡¶¶‡ßç‡¶ß‡¶ø
            // 100-500 ‡¶ü‡¶æ‡¶ï‡¶æ: 20 ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶ï‡¶∞‡ßá ‡¶¨‡ßÉ‡¶¶‡ßç‡¶ß‡¶ø
            // 500-800 ‡¶ü‡¶æ‡¶ï‡¶æ: 50 ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶ï‡¶∞‡ßá ‡¶¨‡ßÉ‡¶¶‡ßç‡¶ß‡¶ø
            
            if (currentPrice >= 20 && currentPrice < 100) {
                increment = 10;
            } else if (currentPrice >= 100 && currentPrice < 500) {
                increment = 20;
            } else if (currentPrice >= 500 && currentPrice <= 800) {
                increment = 50;
            } else if (currentPrice < 20) {
                // If less than 20, increment by 10 to reach 20
                increment = 10;
            } else {
                // After 800, keep incrementing by 50
                increment = 50;
            }
            
            const newPrice = currentPrice + increment;
            priceInput.value = newPrice;
        }

        function setAuctionPrice() {
            const currentPlayers = getCurrentCategoryPlayers();
            if (currentPlayers.length === 0) {
                alert('‚ö†Ô∏è ‡¶ï‡ßã‡¶®‡ßã ‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶®‡ßá‡¶á!');
                return;
            }
            const priceInput = document.getElementById('auctionPriceInput');
            const price = priceInput.value.trim();
            if (!price || isNaN(price) || parseInt(price) <= 0) {
                alert('‚ö†Ô∏è ‡¶∏‡¶†‡¶ø‡¶ï ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®!');
                return;
            }
            const player = currentPlayers[currentPlayerIndex];
            if (!player.team) {
                alert('‚ö†Ô∏è ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶ü‡¶ø‡¶Æ ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®!');
                return;
            }
            const playerIndexInAll = allPlayers.findIndex(p => p.name === player.name && p.category === player.category);
            if (playerIndexInAll !== -1) {
                allPlayers[playerIndexInAll].auctionPrice = price;
                saveToStorage();
                
                showWelcomePage(allPlayers[playerIndexInAll]);
                
                displayCurrentPlayer();
                priceInput.value = '';
            }
        }

        function showResultSheet() {
            const resultSheetOverlay = document.getElementById('resultSheetOverlay');
            currentView = 'all';
            currentTeam = 'Dumuria Kings';
            
            document.querySelectorAll('.view-tab').forEach(tab => {
                tab.classList.remove('active-view');
            });
            document.querySelectorAll('.view-tab')[0].classList.add('active-view');
            
            document.getElementById('teamTabsContainer').style.display = 'none';
            document.getElementById('downloadBtn').textContent = 'üì• ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶∞‡ßá‡¶ú‡¶æ‡¶≤‡ßç‡¶ü ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®';
            document.getElementById('downloadBtn').onclick = downloadAllResult;
            
            showAllResult();
            resultSheetOverlay.style.display = 'flex';
        }

        function changeView(viewType) {
            currentView = viewType;
            
            document.querySelectorAll('.view-tab').forEach(tab => {
                tab.classList.remove('active-view');
            });
            event.target.classList.add('active-view');
            
            if (viewType === 'all') {
                document.getElementById('teamTabsContainer').style.display = 'none';
                document.getElementById('downloadBtn').textContent = 'üì• ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶∞‡ßá‡¶ú‡¶æ‡¶≤‡ßç‡¶ü ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®';
                document.getElementById('downloadBtn').onclick = downloadAllResult;
                showAllResult();
            } else {
                document.getElementById('teamTabsContainer').style.display = 'block';
                document.getElementById('downloadBtn').textContent = 'üì• ‡¶ü‡¶ø‡¶Æ ‡¶á‡¶Æ‡ßá‡¶ú ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®';
                document.getElementById('downloadBtn').onclick = downloadTeamImage;
                
                document.querySelectorAll('.team-tab').forEach(tab => {
                    tab.classList.remove('active-team');
                });
                document.querySelectorAll('.team-tab')[0].classList.add('active-team');
                
                currentTeam = 'Dumuria Kings';
                showTeamPlayers('Dumuria Kings');
            }
        }

        function showAllResult() {
            const resultContainer = document.getElementById('resultContainer');
            const playersToShow = allPlayers;
            
            if (playersToShow.length === 0) {
                resultContainer.innerHTML = '<p style="text-align: center; color: #dc2626; font-weight: bold;">‡¶ï‡ßã‡¶®‡ßã ‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ ‡¶®‡ßá‡¶á‡•§</p>';
            } else {
                let tableHTML = '<table><thead><tr><th>‡¶®‡¶æ‡¶Æ</th><th>‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø</th><th>BASE PRICE</th><th>SOLD PRICE</th><th>‡¶ü‡¶ø‡¶Æ</th><th>‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏</th></tr></thead><tbody>';
                playersToShow.forEach(player => {
                    const status = player.auctionPrice ? 'SOLD' : 'UNSOLD';
                    const priceDisplay = player.auctionPrice ? player.auctionPrice : '---';
                    const teamDisplay = player.team ? player.team : '---';
                    const statusColor = player.auctionPrice ? '#059669' : '#ea580c';
                    const categoryText = player.category === 'ICONIC' ? '‡¶Ü‡¶á‡¶ï‡¶®‡¶ø‡¶ï' : '‡¶®‡¶∞‡¶Æ‡¶æ‡¶≤';
                    tableHTML += `<tr><td>${player.name}</td><td>${categoryText}</td><td>${player.basePrice}</td><td>${priceDisplay}</td><td style="font-weight: bold; color: #9333ea;">${teamDisplay}</td><td style="font-weight: bold; color: ${statusColor};">${status}</td></tr>`;
                });
                tableHTML += '</tbody></table>';
                resultContainer.innerHTML = tableHTML;
            }
        }

        function showTeamPlayers(teamName) {
            currentTeam = teamName;
            
            document.querySelectorAll('.team-tab').forEach(tab => {
                tab.classList.remove('active-team');
            });
            event.target.classList.add('active-team');
            
            const resultContainer = document.getElementById('resultContainer');
            const teamPlayers = allPlayers.filter(p => p.team === teamName && p.auctionPrice);
            
            if (teamPlayers.length === 0) {
                resultContainer.innerHTML = '<div class="no-team-players">‡¶è‡¶á ‡¶ü‡¶ø‡¶Æ‡ßá ‡¶è‡¶ñ‡¶®‡ßã ‡¶ï‡ßã‡¶®‡ßã ‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶®‡ßá‡¶á‡•§</div>';
                return;
            }
            
            let html = '<div class="team-players-grid">';
            teamPlayers.forEach(player => {
                const imageHTML = player.imageURL 
                    ? `<img src="${player.imageURL}" alt="${player.name}" class="player-card-image">`
                    : `<div class="player-card-image" style="background-color: #f3f4f6; display: flex; align-items: center; justify-content: center; font-size: 1em; color: #6b7280;">‡¶õ‡¶¨‡¶ø ‡¶®‡ßá‡¶á</div>`;
                
                html += `
                    <div class="player-card">
                        ${imageHTML}
                        <div class="player-card-name">${player.name}</div>
                        <div class="player-card-price">üí∞ ${player.auctionPrice} ‡¶ü‡¶æ‡¶ï‡¶æ</div>
                    </div>
                `;
            });
            html += '</div>';
            
            resultContainer.innerHTML = html;
        }

        function hideResultSheet(event) {
            if (event && event.target.id !== 'resultSheetOverlay') {
                return;
            }
            document.getElementById('resultSheetOverlay').style.display = 'none';
        }

        function resetData() {
            const confirmReset = confirm("‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶Ø‡ßá ‡¶Ü‡¶™‡¶®‡¶ø ‡¶∏‡¶ï‡¶≤ ‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞‡ßá‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ (‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø‡¶§ ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø ‡¶∏‡¶π) ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶§‡ßá ‡¶ö‡¶æ‡¶®? ‡¶è‡¶á ‡¶ï‡¶æ‡¶ú‡¶ü‡¶ø ‡¶´‡¶ø‡¶∞‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ü‡¶®‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá ‡¶®‡¶æ‡•§");
            if (confirmReset) {
                localStorage.removeItem('cricketPlayers');
                allPlayers = JSON.parse(JSON.stringify(defaultPlayers));
                saveToStorage();
                displayCurrentPlayer();
                alert("‚úÖ ‡¶∏‡¶ï‡¶≤ ‡¶°‡ßá‡¶ü‡¶æ ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá ‡¶è‡¶¨‡¶Ç ‡¶°‡¶ø‡¶´‡¶≤‡ßç‡¶ü ‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§");
            }
        }

        function resetUnsoldPlayers() {
            const confirmReset = confirm("UNSOLD ‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞‡¶¶‡ßá‡¶∞ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø ‡ß®‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®?");
            if (confirmReset) {
                allPlayers.forEach(player => {
                    if (!player.auctionPrice) {
                        player.basePrice = "20";
                        player.team = null; // Reset team selection
                    }
                });
                saveToStorage();
                displayCurrentPlayer();
                alert("‚úÖ UNSOLD ‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞‡¶¶‡ßá‡¶∞ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø ‡ß®‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§");
            }
        }

        function downloadAllResult() {
            const playersToShow = allPlayers;
            const playersPerPage = 25;
            const totalPages = Math.ceil(playersToShow.length / playersPerPage);
            const previewContainer = document.getElementById('pdfPreview');
            previewContainer.innerHTML = '';
            previewContainer.style.display = 'block';
            
            for (let pageNum = 0; pageNum < totalPages; pageNum++) {
                const startIdx = pageNum * playersPerPage;
                const endIdx = Math.min(startIdx + playersPerPage, playersToShow.length);
                const pagePlayers = playersToShow.slice(startIdx, endIdx);
                const pageDiv = document.createElement('div');
                pageDiv.className = 'pdf-page';
                pageDiv.innerHTML = `<h1>CIVIL PREMIER LEAGUE</h1><table><thead><tr><th>‡¶®‡¶æ‡¶Æ</th><th>‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø</th><th>BASE PRICE</th><th>SOLD PRICE</th><th>‡¶ü‡¶ø‡¶Æ</th><th>‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏</th></tr></thead><tbody>${pagePlayers.map(player => {
                    const status = player.auctionPrice ? 'SOLD' : 'UNSOLD';
                    const priceDisplay = player.auctionPrice ? player.auctionPrice : '---';
                    const teamDisplay = player.team ? player.team : '---';
                    const statusClass = player.auctionPrice ? 'sold' : 'unsold';
                    const categoryText = player.category === 'ICONIC' ? '‡¶Ü‡¶á‡¶ï‡¶®‡¶ø‡¶ï' : '‡¶®‡¶∞‡¶Æ‡¶æ‡¶≤';
                    return `<tr><td>${player.name}</td><td>${categoryText}</td><td>${player.basePrice}</td><td>${priceDisplay}</td><td>${teamDisplay}</td><td class="${statusClass}">${status}</td></tr>`;
                }).join('')}</tbody></table><div class="pdf-page-number">‡¶™‡ßÉ‡¶∑‡ßç‡¶†‡¶æ ${pageNum + 1}/${totalPages}</div>`;
                previewContainer.appendChild(pageDiv);
            }
            
            setTimeout(function() {
                processPages(0, previewContainer.querySelectorAll('.pdf-page'));
            }, 100);
        }
        
        function processPages(index, pages) {
            if (index >= pages.length) {
                const previewContainer = document.getElementById('pdfPreview');
                previewContainer.style.display = 'none';
                previewContainer.innerHTML = '';
                alert(`‚úÖ ‡¶Æ‡ßã‡¶ü ${pages.length}‡¶ü‡¶ø ‡¶™‡ßá‡¶ú ‡¶á‡¶Æ‡ßá‡¶ú ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!`);
                return;
            }
            
            html2canvas(pages[index], {
                scale: 2,
                useCORS: true,
                backgroundColor: '#ffffff',
                width: 794,
                height: 1123
            }).then(function(canvas) {
                const link = document.createElement('a');
                link.download = `‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£-‡¶∞‡ßá‡¶ú‡¶æ‡¶≤‡ßç‡¶ü-‡¶™‡ßÉ‡¶∑‡ßç‡¶†‡¶æ-${index + 1}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
                
                setTimeout(function() {
                    processPages(index + 1, pages);
                }, 500);
            });
        }

        async function downloadTeamImage() {
            const teamPlayers = allPlayers.filter(p => p.team === currentTeam && p.auctionPrice);
            
            if (teamPlayers.length === 0) {
                alert('‚ö†Ô∏è ‡¶è‡¶á ‡¶ü‡¶ø‡¶Æ‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶®‡ßá‡¶á!');
                return;
            }
            
            const previewContainer = document.getElementById('teamImagePreview');
            previewContainer.innerHTML = '';
            previewContainer.style.display = 'block';
            previewContainer.style.position = 'fixed';
            previewContainer.style.left = '0';
            previewContainer.style.top = '0';
            
            const pageDiv = document.createElement('div');
            pageDiv.style.width = '1000px';
            pageDiv.style.minHeight = 'auto';
            pageDiv.style.padding = '40px';
            pageDiv.style.background = 'white';
            pageDiv.style.fontFamily = "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif";
            
            let html = `
                <div style="text-align: center; margin-bottom: 30px; padding: 25px; background: linear-gradient(135deg, #9333ea 0%, #7e22ce 100%); border-radius: 15px; box-shadow: 0 10px 30px rgba(147, 51, 234, 0.3);">
                    <h1 style="color: white; font-size: 42px; margin: 0 0 15px 0; font-weight: bold;">üèÜ ${currentTeam}</h1>
                    <div style="color: white; font-size: 20px; font-weight: bold; margin-bottom: 8px;">‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ - ‡ß®‡ß¶‡ß®‡ß´</div>
                    <div style="color: white; font-size: 18px; opacity: 0.9;">‡¶Æ‡ßã‡¶ü ‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞: ${teamPlayers.length} ‡¶ú‡¶®</div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-top: 30px;">
            `;
            
            const imagePromises = teamPlayers.map(player => {
                return new Promise((resolve) => {
                    if (player.imageURL) {
                        const img = new Image();
                        img.crossOrigin = 'anonymous';
                        img.onload = () => resolve({ player, img });
                        img.onerror = () => resolve({ player, img: null });
                        img.src = player.imageURL;
                    } else {
                        resolve({ player, img: null });
                    }
                });
            });
            
            const loadedImages = await Promise.all(imagePromises);
            
            loadedImages.forEach(({ player, img }) => {
                let imageHTML;
                if (img) {
                    imageHTML = `<img src="${player.imageURL}" crossorigin="anonymous" alt="${player.name}" style="width: 140px; height: 140px; border-radius: 50%; object-fit: cover; margin: 0 auto 15px auto; display: block; border: 4px solid #9333ea; box-shadow: 0 5px 15px rgba(147, 51, 234, 0.3);">`;
                } else {
                    imageHTML = `<div style="width: 140px; height: 140px; border-radius: 50%; background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%); display: flex; align-items: center; justify-content: center; margin: 0 auto 15px auto; border: 4px solid #9ca3af; font-size: 16px; color: #6b7280; font-weight: bold;">‡¶õ‡¶¨‡¶ø ‡¶®‡ßá‡¶á</div>`;
                }
                
                html += `
                    <div style="text-align: center; padding: 20px; border: 3px solid #9333ea; border-radius: 12px; background: white; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);">
                        ${imageHTML}
                        <div style="font-size: 16px; font-weight: bold; color: #1f2937; margin-bottom: 8px; line-height: 1.4;">${player.name}</div>
                        <div style="font-size: 18px; font-weight: bold; color: #059669; padding: 8px 12px; background: #d1fae5; border-radius: 8px; display: inline-block;">üí∞ ${player.auctionPrice} ‡¶ü‡¶æ‡¶ï‡¶æ</div>
                    </div>
                `;
            });
            
            html += '</div>';
            html += `
                <div style="text-align: center; margin-top: 35px; padding: 18px; background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%); border-radius: 10px; border: 2px solid #d1d5db;">
                    <div style="font-size: 15px; color: #1f2937; font-weight: 600; line-height: 1.6;">
                        CIVIL PREMIER LEAGUE
                    </div>
                </div>
            `;
            pageDiv.innerHTML = html;
            previewContainer.appendChild(pageDiv);
            
            setTimeout(function() {
                html2canvas(pageDiv, {
                    scale: 2,
                    useCORS: true,
                    allowTaint: true,
                    backgroundColor: '#ffffff',
                    width: 1000,
                    logging: false,
                    imageTimeout: 0
                }).then(function(canvas) {
                    const link = document.createElement('a');
                    link.download = `${currentTeam}-‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞-‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ-${Date.now()}.png`;
                    link.href = canvas.toDataURL('image/png', 1.0);
                    link.click();
                    
                    previewContainer.style.display = 'none';
                    previewContainer.innerHTML = '';
                    alert(`‚úÖ ${currentTeam} ‡¶è‡¶∞ ‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!`);
                }).catch(function(error) {
                    console.error('Error generating image:', error);
                    previewContainer.style.display = 'none';
                    previewContainer.innerHTML = '';
                    alert('‚ö†Ô∏è ‡¶á‡¶Æ‡ßá‡¶ú ‡¶§‡ßà‡¶∞‡¶ø‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§');
                });
            }, 500);
        }

        window.onload = init;
    </script>
</body>
</html>
